// Composition Operations

// Sequencial (priority 2)
process = A : B;
//  |-----|      |-----|
//  |     1----->1     |
//  |  A  |      |  B  |
//  |     2----->2     |
//  |-----|      |-----|


//=============================================

// Parallel (priority 3)
process = A, B;
//     _____
//    |     |
//  ->1     1->
//    |  A  |
//  ->2     2->
//    |_____|
//     _____ 
//    |     |
//  ->3  B  3->
//    |_____|


//=============================================

// Split (priority 1)
// Number of inputs of B = n * Number of outputs of A
process = A <: B;
//  |-----|         |-----|
//  |     |    +--->1     |
//  |  A  1----|    |  B  |
//  |     |    +--->2     |
//  |-----|         |-----|

//  |-----|         |-----|
//  |     |  +----->1     |
//  |     1--|      |     |
//  |     |  | +--->2     |
//  |  A  |  | |    |  B  |
//  |     |  +-|--->3     |
//  |     2----|    |     |
//  |     |    +--->4     |
//  |-----|         |-----|

//=============================================

// Merge (priority 1)
// Number of outputs of A = n * Number of inputs of B
process = A :> B;
//  |-----|         |-----|
//  |     1----+    |     |
//  |  A  |    |--->1  B  |
//  |     2----+    |     |
//  |-----|         |-----|

//  |-----|         |-----|
//  |     1---+     |     |
//  |     |   |---->1     |
//  |     2---|-+   |     |
//  |  A  |   | |   |  B  |
//  |     3---+ |   |     |
//  |     |     |-->2     |
//  |     4-----+   |     |
//  |-----|         |-----|


//=============================================

// Recursive (priority 4)
// Number of inputs of B <= Number of outputs of A
// Number of outputs of B <= Number of inputs of A
process = A ~ B;

//    |-.-----|
//  ->1       1->
//    |       |          |-.-----|
//  ->2       2->      ->1       1->
//    |   A   |          |   B   |
//  ->3       3->      ->2       2->
//    |       |          |-------|
//  ->4       4->
//    |-------|

// STEP I - Rotate B and Put it on top of A

//            |-------|
//          <-2       2<-
//            |   B   |
//          <-1       1<-
//            |-----.-| 
//
//
//            |-.-----|
//          ->1       1->
//            |       |
//          ->2       2->
//            |   A   |
//          ->3       3->
//            |       |
//          ->4       4->
//            |-------|


// STEP II - Connect output of A with 1-sample delay to inputs of B
//         - Connect output of B to inputs of A

//            |-------|
//     +------2       2<-----+
//     |      |   B   |      |
//     |   +--1       1<-+   |
//     |   |  |-----.-|  |   |
//     |   |             |   |
//     |   |             |   |
//     |   |  |-.-----|  |   |
//     |   +->1       1-|^|--|--->
//     |      |       |      |
//     +----->2       2-----|^|-->
//            |   A   |
//  --------->3       3---------->
//            |       |
//  --------->4       4---------->
//            |-------|

//=============================================
// Some valid recursive connections
//=============================================

//            |-------|
//     +------2       2<-----+
//     |      |   B   |      |
//     |   +--1       1<-+   |
//     |   |  |-----.-|  |   |
//     |   |             |   |
//     |   |             |   |
//     |   |  |-.-----|  |   |
//     |   +->1       1-|^|--|--->
//     |      |   A   |      |
//     +----->2       2-----|^|-->
//            |-------|

//=============================================
// Some valid recursive connections
//=============================================


//            |-------|
//        +---1   B   1<--+
//        |   |-----.-|   |
//        |               |
//        |               |
//        |   |-.-----|   |
//        +-->1       1--|^|----->
//            |   A   |
//  --------->2       2---------->
//            |-------|

//=============================================

(No)   _ ~ +
(Yes)  + ~ _
(No)   1 ~ _
(Yes)  + ~ (_,2:*)
(Yes)  (1,_:+) ~ (_,2:*)
(Yes)  + ~ (_,2 <: *,+)
